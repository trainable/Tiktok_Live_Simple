<<<<<<< HEAD
# TikTok ç®€åŒ–ç›´æ’­é—´ Android åº”ç”¨

ä¸€ä¸ªé«˜æ€§èƒ½çš„ Android ç›´æ’­åº”ç”¨ï¼Œé‡‡ç”¨ MVVM æž¶æž„ï¼Œæ”¯æŒ DASH ç›´æ’­æµæ’­æ”¾ã€å®žæ—¶è¯„è®ºã€åœ¨çº¿äººæ•°ç»Ÿè®¡ç­‰åŠŸèƒ½ã€‚é€šè¿‡å¤šç§æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ï¼Œå®žçŽ°äº†æµç•…çš„ç›´æ’­è§‚çœ‹ä½“éªŒã€‚

## ðŸ“± é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªä»¿ TikTok ç›´æ’­é—´çš„ Android åº”ç”¨ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

- ðŸŽ¥ **DASH ç›´æ’­æµæ’­æ”¾**ï¼šä½¿ç”¨ xgplayer + Shaka.js æ’­æ”¾å™¨ï¼Œæ”¯æŒæµç•…çš„ç›´æ’­æµæ’­æ”¾
- ðŸ’¬ **å®žæ—¶è¯„è®ºç³»ç»Ÿ**ï¼šæ”¯æŒå‘é€å’ŒæŽ¥æ”¶å®žæ—¶è¯„è®ºï¼Œè¯„è®ºåˆ—è¡¨è‡ªåŠ¨æ»šåŠ¨
- ðŸ‘¥ **åœ¨çº¿äººæ•°ç»Ÿè®¡**ï¼šé€šè¿‡ WebSocket å®žæ—¶æ›´æ–°åœ¨çº¿è§‚ä¼—æ•°é‡
- ðŸŽ¯ **æ€§èƒ½ä¼˜åŒ–**ï¼šé¢„åŠ è½½ã€è§†å›¾æ± ã€TTL ç¼“å­˜ç­‰å¤šç§ä¼˜åŒ–æŠ€æœ¯
- ðŸ”Œ **æ’ä»¶åŒ–æž¶æž„**ï¼šæ”¯æŒç‚¹èµžã€ç¤¼ç‰©ã€èŠå¤©ç­‰æ’ä»¶åŠŸèƒ½

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. å¯åŠ¨æµç¨‹
- **SplashActivity**ï¼šå¯åŠ¨é¡µï¼Œæ˜¾ç¤ºåº”ç”¨ Logoï¼ŒåŽå°é¢„åŠ è½½å…³é”®ç»„ä»¶
- é¢„åŠ è½½ WebViewã€WebSocketã€æˆ¿é—´ä¿¡æ¯ã€å›¾ç‰‡ç­‰èµ„æº
- ç¡®ä¿å¯åŠ¨åŽå¿«é€Ÿè¿›å…¥ç›´æ’­é—´

### 2. ç›´æ’­é—´åˆ—è¡¨
- **RoomListActivity**ï¼šæ˜¾ç¤ºæ‰€æœ‰ç›´æ’­é—´åˆ—è¡¨
- ç½‘æ ¼å¸ƒå±€å±•ç¤ºç›´æ’­é—´ç¼©ç•¥å›¾å’Œä¸»æ’­ä¿¡æ¯
- æ”¯æŒé¢„åŠ è½½å’Œå›¾ç‰‡ç¼“å­˜

### 3. ç›´æ’­é—´è¯¦æƒ…
- **LiveRoomActivity**ï¼šç›´æ’­é—´ä¸»ç•Œé¢
  - è§†é¢‘æ’­æ”¾åŒºåŸŸï¼ˆWebView + xgplayerï¼‰
  - ä¸»æ’­ä¿¡æ¯å±•ç¤ºï¼ˆå¤´åƒã€åç§°ã€å…³æ³¨æ•°ï¼‰
  - å®žæ—¶è¯„è®ºåˆ—è¡¨ï¼ˆRecyclerViewï¼‰
  - åœ¨çº¿äººæ•°æ˜¾ç¤º
  - è¯„è®ºè¾“å…¥å’Œå‘é€åŠŸèƒ½

### 4. æ€§èƒ½ä¼˜åŒ–
- **é¢„åŠ è½½æœºåˆ¶**ï¼šå¯åŠ¨æ—¶é¢„åŠ è½½ WebViewã€WebSocketã€æˆ¿é—´ä¿¡æ¯
- **TTL ç¼“å­˜**ï¼šé€€å‡ºç›´æ’­é—´åŽ 30 ç§’å†…é‡æ–°è¿›å…¥ï¼Œå¿«é€Ÿæ¢å¤å®Œæ•´çŠ¶æ€
- **è§†å›¾æ± **ï¼šå¤ç”¨ RecyclerView çš„ item å¸ƒå±€ï¼Œå‡å°‘ inflate å¼€é”€
- **å¸ƒå±€é¢„åŠ è½½**ï¼šé¢„æ¸²æŸ“ Activity å¸ƒå±€ï¼Œå‡å°‘é¦–æ¬¡æ¸²æŸ“æ—¶é—´
- **å›¾ç‰‡é¢„åŠ è½½**ï¼šä½¿ç”¨ Glide é¢„åŠ è½½ä¸»æ’­å¤´åƒ

## ðŸ—ï¸ æŠ€æœ¯æ ˆ

### æž¶æž„æ¨¡å¼
- **MVVM (Model-View-ViewModel)**ï¼šæ¸…æ™°çš„èŒè´£åˆ†ç¦»ï¼Œæ•°æ®é©±åŠ¨ UI
- **Repository æ¨¡å¼**ï¼šç»Ÿä¸€æ•°æ®è®¿é—®æŽ¥å£
- **æ’ä»¶åŒ–æž¶æž„**ï¼šæ”¯æŒåŠŸèƒ½æ‰©å±•

### æ ¸å¿ƒæŠ€æœ¯
- **xgplayer**ï¼šHTML5 è§†é¢‘æ’­æ”¾å™¨ï¼ˆé›†æˆ Shaka.js æ”¯æŒ DASHï¼‰
- **WebView**ï¼šæ‰¿è½½æ’­æ”¾å™¨ï¼Œæ”¯æŒç¡¬ä»¶åŠ é€Ÿ
- **OkHttp**ï¼šç½‘ç»œè¯·æ±‚åº“
- **Gson**ï¼šJSON è§£æž
- **Glide**ï¼šå›¾ç‰‡åŠ è½½å’Œç¼“å­˜
- **WebSocket**ï¼šå®žæ—¶é€šä¿¡ï¼ˆåœ¨çº¿äººæ•°ã€è¯„è®ºï¼‰

### Android ç»„ä»¶
- **Lifecycle & LiveData**ï¼šç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ï¼Œå“åº”å¼æ•°æ®æ›´æ–°
- **ViewModel**ï¼šç®¡ç† UI ç›¸å…³æ•°æ®ï¼Œç‹¬ç«‹äºŽ Activity ç”Ÿå‘½å‘¨æœŸ
- **RecyclerView**ï¼šåˆ—è¡¨å±•ç¤ºï¼Œæ”¯æŒ DiffUtil ä¼˜åŒ–
- **ConstraintLayout**ï¼šçµæ´»çš„å¸ƒå±€ç³»ç»Ÿ

## ðŸ“‚ é¡¹ç›®ç»“æž„

```
app/src/main/java/com/bytedance/myapplication/
â”‚
â”œâ”€â”€ activity/                    # View å±‚ - Activity
â”‚   â”œâ”€â”€ SplashActivity.java      # å¯åŠ¨é¡µï¼Œé¢„åŠ è½½å…³é”®ç»„ä»¶
â”‚   â”œâ”€â”€ RoomListActivity.java    # ç›´æ’­é—´åˆ—è¡¨
â”‚   â””â”€â”€ LiveRoomActivity.java    # ç›´æ’­é—´è¯¦æƒ…ï¼ˆæ ¸å¿ƒç•Œé¢ï¼‰
â”‚
â”œâ”€â”€ adapter/                     # View å±‚ - åˆ—è¡¨é€‚é…å™¨
â”‚   â”œâ”€â”€ CommentAdapter.java      # è¯„è®ºåˆ—è¡¨é€‚é…å™¨ï¼ˆæ”¯æŒé•¿æ–‡æœ¬æˆªæ–­ï¼‰
â”‚   â””â”€â”€ RoomListAdapter.java    # ç›´æ’­é—´åˆ—è¡¨é€‚é…å™¨
â”‚
â”œâ”€â”€ viewmodel/                   # ViewModel å±‚ - ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ LiveRoomViewModel.java   # ç›´æ’­é—´ä¸šåŠ¡é€»è¾‘ï¼ˆä¸»æ’­ã€è¯„è®ºã€åœ¨çº¿äººæ•°ï¼‰
â”‚   â””â”€â”€ RoomListViewModel.java   # ç›´æ’­é—´åˆ—è¡¨ä¸šåŠ¡é€»è¾‘
â”‚
â”œâ”€â”€ repository/                  # Model å±‚ - æ•°æ®ä»“åº“
â”‚   â””â”€â”€ LiveRoomRepository.java  # ç»Ÿä¸€æ•°æ®è®¿é—®æŽ¥å£
â”‚
â”œâ”€â”€ model/                       # Model å±‚ - æ•°æ®æ¨¡åž‹
â”‚   â”œâ”€â”€ Host.java                # ä¸»æ’­ä¿¡æ¯æ¨¡åž‹
â”‚   â””â”€â”€ Comment.java             # è¯„è®ºä¿¡æ¯æ¨¡åž‹
â”‚
â”œâ”€â”€ utils/                       # å·¥å…·ç±»
â”‚   â”œâ”€â”€ PreloadManager.java      # é¢„åŠ è½½ç®¡ç†å™¨ï¼ˆWebViewã€WebSocketã€TTLç¼“å­˜ï¼‰
â”‚   â”œâ”€â”€ WebViewConfigHelper.java # WebView é…ç½®ä¼˜åŒ–
â”‚   â”œâ”€â”€ WebSocketManager.java    # WebSocket è¿žæŽ¥ç®¡ç†
â”‚   â”œâ”€â”€ ApiService.java          # HTTP API æœåŠ¡
â”‚   â”œâ”€â”€ ViewPoolManager.java     # RecyclerView è§†å›¾æ± ç®¡ç†
â”‚   â”œâ”€â”€ ActivityLayoutPreloader.java # Activity å¸ƒå±€é¢„åŠ è½½
â”‚   â”œâ”€â”€ PerformanceMonitor.java  # æ€§èƒ½ç›‘æŽ§
â”‚   â””â”€â”€ SmoothnessMonitor.java   # æµç•…åº¦ç›‘æŽ§
â”‚
â”œâ”€â”€ plugin/                      # æ’ä»¶åŒ–æž¶æž„
â”‚   â”œâ”€â”€ PluginManager.java       # æ’ä»¶ç®¡ç†å™¨
â”‚   â”œâ”€â”€ IPlugin.java             # æ’ä»¶æŽ¥å£
â”‚   â”œâ”€â”€ BasePlugin.java          # æ’ä»¶åŸºç±»
â”‚   â””â”€â”€ example/                 # ç¤ºä¾‹æ’ä»¶
â”‚       â”œâ”€â”€ LikePlugin.java      # ç‚¹èµžæ’ä»¶
â”‚       â”œâ”€â”€ GiftPlugin.java      # ç¤¼ç‰©æ’ä»¶
â”‚       â””â”€â”€ ChatPlugin.java      # èŠå¤©æ’ä»¶
â”‚
â””â”€â”€ LiveBoard.java               # Application ç±»ï¼ˆå…¨å±€åˆå§‹åŒ–ï¼‰
```

### èµ„æºæ–‡ä»¶ç»“æž„

```
app/src/main/res/
â”œâ”€â”€ layout/                      # å¸ƒå±€æ–‡ä»¶
â”‚   â”œâ”€â”€ activity_splash.xml      # å¯åŠ¨é¡µå¸ƒå±€
â”‚   â”œâ”€â”€ activity_room_list.xml  # ç›´æ’­é—´åˆ—è¡¨å¸ƒå±€
â”‚   â”œâ”€â”€ activity_live_room.xml  # ç›´æ’­é—´è¯¦æƒ…å¸ƒå±€
â”‚   â”œâ”€â”€ item_comment.xml         # è¯„è®ºé¡¹å¸ƒå±€
â”‚   â””â”€â”€ item_room.xml           # ç›´æ’­é—´é¡¹å¸ƒå±€
â”‚
â”œâ”€â”€ drawable/                    # å›¾ç‰‡èµ„æº
â”‚   â”œâ”€â”€ tiktok_logo.png         # åº”ç”¨ Logo
â”‚   â””â”€â”€ splash_logo_background.xml # å¯åŠ¨é¡µ Logo èƒŒæ™¯
â”‚
â””â”€â”€ assets/                      # èµ„æºæ–‡ä»¶
    â”œâ”€â”€ player.html              # æ’­æ”¾å™¨ HTMLï¼ˆxgplayer + Shaka.jsï¼‰
    â””â”€â”€ dash_live_final.html     # DASH ç›´æ’­æµæµ‹è¯•é¡µé¢
```

## ðŸš€ æ ¸å¿ƒæµç¨‹

### åº”ç”¨å¯åŠ¨æµç¨‹

```
1. LiveBoard.onCreate()
   â”œâ”€â”€ åˆ›å»ºå…¨å±€çº¿ç¨‹æ± 
   â”œâ”€â”€ åˆå§‹åŒ–æ’ä»¶ç®¡ç†å™¨
   â”œâ”€â”€ åˆå§‹åŒ–è§†å›¾æ± ç®¡ç†å™¨
   â”œâ”€â”€ åˆå§‹åŒ–å¸ƒå±€é¢„åŠ è½½å™¨
   â””â”€â”€ å¯åŠ¨é¢„åŠ è½½ç®¡ç†å™¨

2. SplashActivity.onCreate()
   â”œâ”€â”€ æ˜¾ç¤ºå¯åŠ¨é¡µ UI
   â”œâ”€â”€ å¯åŠ¨ PreloadManager.startPreload()
   â”‚   â”œâ”€â”€ é¢„åŠ è½½ WebView
   â”‚   â”œâ”€â”€ é¢„åŠ è½½ WebSocket
   â”‚   â”œâ”€â”€ é¢„åŠ è½½æˆ¿é—´ä¿¡æ¯ï¼ˆJSONï¼‰
   â”‚   â””â”€â”€ é¢„åŠ è½½å›¾ç‰‡
   â””â”€â”€ ç­‰å¾…é¢„åŠ è½½å®Œæˆï¼ˆæœ€å¤š 5 ç§’ï¼‰

3. è·³è½¬åˆ° RoomListActivity
   â””â”€â”€ æ˜¾ç¤ºç›´æ’­é—´åˆ—è¡¨
```

### è¿›å…¥ç›´æ’­é—´æµç¨‹

```
1. ç”¨æˆ·ç‚¹å‡»ç›´æ’­é—´
   â””â”€â”€ å¯åŠ¨ LiveRoomActivity

2. LiveRoomActivity.setupVideoPlayer()
   â”œâ”€â”€ æ£€æŸ¥ TTL ç¼“å­˜
   â”‚   â”œâ”€â”€ æœ‰ç¼“å­˜ä¸”æœ‰æ•ˆ â†’ æ¢å¤ WebView å’Œå®Œæ•´çŠ¶æ€
   â”‚   â””â”€â”€ æ— ç¼“å­˜æˆ–æ— æ•ˆ â†’ ç»§ç»­ä¸‹ä¸€æ­¥
   â”œâ”€â”€ item1 ç¬¬ä¸€æ¬¡è¿›å…¥ â†’ æ£€æŸ¥é¢„åŠ è½½çš„ WebView
   â””â”€â”€ å…¶ä»–æƒ…å†µ â†’ ä½¿ç”¨å¸ƒå±€ä¸­çš„ WebViewï¼Œè°ƒç”¨ loadPlayer()

3. åŠ è½½æ•°æ®
   â”œâ”€â”€ viewModel.loadHostInfo() â†’ èŽ·å–ä¸»æ’­ä¿¡æ¯
   â”œâ”€â”€ viewModel.loadComments() â†’ èŽ·å–è¯„è®ºåˆ—è¡¨
   â””â”€â”€ viewModel.setupWebSocket() â†’ è¿žæŽ¥ WebSocketï¼ˆåœ¨çº¿äººæ•°ï¼‰

4. æ’­æ”¾å™¨åŠ è½½
   â””â”€â”€ WebView.loadUrl("file:///android_asset/player.html?url=...")
       â””â”€â”€ xgplayer åˆå§‹åŒ– â†’ Shaka.js åŠ è½½ DASH æµ â†’ å¼€å§‹æ’­æ”¾
```

### é€€å‡ºç›´æ’­é—´æµç¨‹

```
1. LiveRoomActivity.onDestroy()
   â”œâ”€â”€ æ£€æŸ¥ WebView çŠ¶æ€
   â”‚   â”œâ”€â”€ æ­£åœ¨åŠ è½½ä¸­ â†’ å›žæ”¶åˆ°å¤ç”¨æ± 
   â”‚   â””â”€â”€ å·²åŠ è½½å®Œæˆ â†’ ä¿å­˜åˆ° TTL ç¼“å­˜
   â”‚       â”œâ”€â”€ WebViewï¼ˆä¿æŒæ´»è·ƒï¼Œé™éŸ³æ’­æ”¾ï¼‰
   â”‚       â”œâ”€â”€ ä¸»æ’­ä¿¡æ¯
   â”‚       â”œâ”€â”€ è¯„è®ºåˆ—è¡¨
   â”‚       â”œâ”€â”€ åœ¨çº¿äººæ•°
   â”‚       â””â”€â”€ è¯„è®ºæ»šåŠ¨ä½ç½®
   â””â”€â”€ æ¸…ç†èµ„æº
```

## âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯

### 1. é¢„åŠ è½½æœºåˆ¶ï¼ˆPreloadManagerï¼‰

**æè¿°**ï¼š
- ä¸ºäº†è®©ç”¨æˆ·å¯ä»¥å‡å°‘æ•°æ®åŠ è½½æ—¶é—´
- å‡è®¾item1ä¸ºç”¨æˆ·å¸¸åŽ»ç›´æ’­é—´ï¼Œæ–¹ä¾¿ç”¨æˆ·æ‰“å¼€è½¯ä»¶çš„æ—¶å€™å¯ä»¥ç›´æŽ¥èŽ·å–åˆ°è¯¥ç›´æ’­é—´æ•°æ®ï¼Œç›´æŽ¥0msæ¸²æŸ“


**åŠŸèƒ½**ï¼š
- å¯åŠ¨æ—¶é¢„åŠ è½½ WebViewã€WebSocketã€æˆ¿é—´ä¿¡æ¯ã€å›¾ç‰‡
- é¢„åŠ è½½ item1 çš„ç›´æ’­æµï¼ˆåŽå°æ’­æ”¾ï¼‰
- ç®¡ç† TTL ç¼“å­˜ï¼ˆ30 ç§’æœ‰æ•ˆæœŸï¼‰



### 2. TTL ç¼“å­˜ï¼ˆTime-To-Live Cacheï¼‰

**åŠŸèƒ½**ï¼š
- é€€å‡ºç›´æ’­é—´åŽ 30 ç§’å†…é‡æ–°è¿›å…¥ï¼Œå¿«é€Ÿæ¢å¤å®Œæ•´çŠ¶æ€
- ä¿å­˜ WebViewã€ä¸»æ’­ä¿¡æ¯ã€è¯„è®ºã€åœ¨çº¿äººæ•°ã€æ»šåŠ¨ä½ç½®

**å…³é”®ç‰¹æ€§**ï¼š
- WebView åœ¨éšè—å®¹å™¨ä¸­ä¿æŒæ´»è·ƒæ’­æ”¾ï¼ˆé™éŸ³ï¼‰
- åˆ‡å›žæ—¶åªéœ€å–æ¶ˆé™éŸ³ï¼Œæ— éœ€é‡æ–°åŠ è½½
- å¦‚æžœæ•°æ®ä¸å®Œæ•´ï¼ˆå¦‚ä¸»æ’­ä¿¡æ¯æœªåŠ è½½ï¼‰ï¼Œä¸ä¿å­˜åˆ° TTL ç¼“å­˜

### 3. è§†å›¾æ± ï¼ˆViewPoolManagerï¼‰

**åŠŸèƒ½**ï¼š
- å¤ç”¨ RecyclerView çš„ item å¸ƒå±€ï¼Œå‡å°‘ inflate å¼€é”€
- é¢„åŠ è½½ `item_comment` å’Œ `item_room` å¸ƒå±€



### 4. å¸ƒå±€é¢„åŠ è½½ï¼ˆActivityLayoutPreloaderï¼‰

**åŠŸèƒ½**ï¼š
- é¢„æ¸²æŸ“ Activity å¸ƒå±€ï¼Œå‡å°‘é¦–æ¬¡æ¸²æŸ“æ—¶é—´
- ä½¿ç”¨ `LayoutInflater.inflate()` é¢„åˆ›å»º View æ ‘



### 5. å›¾ç‰‡é¢„åŠ è½½ï¼ˆGlideï¼‰

**åŠŸèƒ½**ï¼š
- å¯åŠ¨æ—¶é¢„åŠ è½½ä¸»æ’­å¤´åƒ
- ä½¿ç”¨ Glide çš„ç¼“å­˜æœºåˆ¶


### 6. WebView ä¼˜åŒ–

**é…ç½®**ï¼š
- ç¡¬ä»¶åŠ é€Ÿï¼ˆæ”¯æŒæ—¶ï¼‰
- JavaScript æŽ¥å£
- ç¼“å­˜ç­–ç•¥ä¼˜åŒ–


### 7. é˜²æŠ–æœºåˆ¶

**åœ¨çº¿äººæ•°æ›´æ–°é˜²æŠ–**ï¼š
- ç´¯ç§¯å¤šæ¬¡ WebSocket æ¶ˆæ¯åŽï¼Œå»¶è¿Ÿ 500ms ä¸€æ¬¡æ€§æ›´æ–° UI
- é¿å…é¢‘ç¹çš„ `setText()` æ“ä½œ

**è¯„è®ºæ»šåŠ¨é˜²æŠ–**ï¼š
- å»¶è¿Ÿ 200ms æ‰§è¡Œæ»šåŠ¨æ“ä½œ
- å‡å°‘å¸ƒå±€è®¡ç®—é¢‘çŽ‡

## ðŸ”Œ æ’ä»¶åŒ–æž¶æž„

### æ’ä»¶æŽ¥å£

```java
public interface IPlugin {
    String getName();
    void onActivate(Activity activity);
    void onDeactivate();
    boolean isEnabled();
}
```

### ç¤ºä¾‹æ’ä»¶

1. **LikePluginï¼ˆç‚¹èµžæ’ä»¶ï¼‰**
   - ç®¡ç†ç‚¹èµžæ•°å’Œç‚¹èµžçŠ¶æ€
   - æä¾› LiveData ä¾› UI è§‚å¯Ÿ

2. **GiftPluginï¼ˆç¤¼ç‰©æ’ä»¶ï¼‰**
   - å‘é€ç¤¼ç‰©åŠŸèƒ½
   - ç¤¼ç‰©åŠ¨ç”»æ•ˆæžœ

3. **ChatPluginï¼ˆèŠå¤©æ’ä»¶ï¼‰**
   - æ‰©å±•èŠå¤©åŠŸèƒ½


## ðŸ“Š æ€§èƒ½ç›‘æŽ§

### PerformanceMonitor

**åŠŸèƒ½**ï¼š
- è®°å½•åº”ç”¨å¯åŠ¨æ—¶é—´
- è®°å½•é¡µé¢å¯åŠ¨å’Œæ¸²æŸ“æ—¶é—´
- è®°å½•å›¾ç‰‡åŠ è½½æ—¶é—´
- è®°å½•è§†é¢‘æ’­æ”¾æ€§èƒ½æŒ‡æ ‡

**ä½¿ç”¨**ï¼š
```java
// è®°å½•é¡µé¢å¯åŠ¨
PerformanceMonitor.recordPageStartTime("LiveRoomActivity");

// è®°å½•é¡µé¢æ¸²æŸ“
PerformanceMonitor.recordPageRenderTime("LiveRoomActivity");

// è®°å½•è§†é¢‘æ€§èƒ½
PerformanceMonitor.recordVideoPerformanceMetrics(pageId, metrics);
```

### SmoothnessMonitor

**åŠŸèƒ½**ï¼š
- ç›‘æŽ§é¡µé¢æµç•…åº¦ï¼ˆFPSï¼‰
- æ£€æµ‹å¡é¡¿æƒ…å†µ

## ðŸŽ¨ UI è®¾è®¡

### å¸ƒå±€å±‚çº§

```
ConstraintLayout (æ ¹å¸ƒå±€)
â”œâ”€â”€ WebView (è§†é¢‘æ’­æ”¾åŒºåŸŸï¼Œelevation=0dp)
â”œâ”€â”€ host_info_layout (ä¸»æ’­ä¿¡æ¯ï¼Œelevation=10dp)
â”œâ”€â”€ online_count (åœ¨çº¿äººæ•°ï¼Œelevation=10dp)
â”œâ”€â”€ like_container_stub (ç‚¹èµžæŒ‰é’®ï¼ŒViewStub å»¶è¿ŸåŠ è½½)
â”œâ”€â”€ comment_recycler_view (è¯„è®ºåˆ—è¡¨)
â””â”€â”€ comment_input_layout (è¯„è®ºè¾“å…¥åŒºåŸŸ)
```

**å…³é”®è®¾è®¡**ï¼š
- WebView åœ¨åº•å±‚ï¼Œå…¶ä»–ç»„ä»¶åœ¨ä¸Šå±‚ï¼ˆé€šè¿‡ elevation æŽ§åˆ¶ï¼‰
- ä½¿ç”¨ ViewStub å»¶è¿ŸåŠ è½½ç‚¹èµž UI
- è¯„è®ºåˆ—è¡¨æ”¯æŒé•¿æ–‡æœ¬æˆªæ–­å’Œå±•å¼€

## ðŸ”§ é…ç½®è¯´æ˜Ž

### ç½‘ç»œé…ç½®

- **API åŸºç¡€åœ°å€**ï¼šåœ¨ `ApiService.java` ä¸­é…ç½®
- **WebSocket åœ°å€**ï¼šåœ¨ `WebSocketManager.java` ä¸­é…ç½®
- **ç›´æ’­æµåœ°å€**ï¼šåœ¨ `LiveRoomActivity.java` ä¸­é…ç½® `DEFAULT_STREAM_URL`

### é¢„åŠ è½½é…ç½®

- **TTL ç¼“å­˜æ—¶é—´**ï¼š30 ç§’ï¼ˆ`PreloadManager.DEFAULT_TTL_MS`ï¼‰
- **é¢„åŠ è½½ç­‰å¾…æ—¶é—´**ï¼šæœ€å¤š 5 ç§’ï¼ˆ`SplashActivity.MAX_WAIT_TIME_MS`ï¼‰
- **æœ€å°æ˜¾ç¤ºæ—¶é—´**ï¼š1.5 ç§’ï¼ˆ`SplashActivity.MIN_DISPLAY_TIME_MS`ï¼‰

## ðŸ“ ä»£ç è§„èŒƒ

### å‘½åè§„èŒƒ
- **Activity**ï¼š`XxxActivity.java`
- **ViewModel**ï¼š`XxxViewModel.java`
- **Repository**ï¼š`XxxRepository.java`
- **Adapter**ï¼š`XxxAdapter.java`
- **å·¥å…·ç±»**ï¼š`XxxHelper.java` æˆ– `XxxManager.java`

### æ³¨é‡Šè§„èŒƒ
- ç±»å’Œæ–¹æ³•ä½¿ç”¨ JavaDoc æ³¨é‡Š
- å…³é”®é€»è¾‘æ·»åŠ è¡Œå†…æ³¨é‡Š
- å¤æ‚ç®—æ³•æ·»åŠ è¯´æ˜Žæ³¨é‡Š

### ä»£ç ç»„ç»‡
- æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ä»£ç 
- å·¥å…·ç±»ç»Ÿä¸€æ”¾åœ¨ `utils` åŒ…
- éµå¾ªå•ä¸€èŒè´£åŽŸåˆ™

## ðŸš€ å¿«é€Ÿå¼€å§‹

### çŽ¯å¢ƒè¦æ±‚

- Android Studio Hedgehog | 2023.1.1 æˆ–æ›´é«˜ç‰ˆæœ¬
- JDK 11 æˆ–æ›´é«˜ç‰ˆæœ¬
- Android SDK 23+ (Android 6.0+)
- Gradle 8.0+

### æž„å»ºæ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd MyApplication2
   ```

2. **é…ç½®ç½‘ç»œåœ°å€**
   - ä¿®æ”¹ `ApiService.java` ä¸­çš„ API åŸºç¡€åœ°å€
   - ä¿®æ”¹ `WebSocketManager.java` ä¸­çš„ WebSocket åœ°å€
   - ä¿®æ”¹ `LiveRoomActivity.java` ä¸­çš„ `DEFAULT_STREAM_URL`



3. **è¿è¡Œåº”ç”¨**
   - åœ¨ Android Studio ä¸­æ‰“å¼€é¡¹ç›®
   - è¿žæŽ¥ Android è®¾å¤‡æˆ–å¯åŠ¨æ¨¡æ‹Ÿå™¨
   - ç‚¹å‡» Run æŒ‰é’®



## ðŸ” å…³é”®ä»£ç ä½ç½®

### æ ¸å¿ƒ Activity
- **å¯åŠ¨é¡µ**ï¼š`activity/SplashActivity.java`
- **ç›´æ’­é—´åˆ—è¡¨**ï¼š`activity/RoomListActivity.java`
- **ç›´æ’­é—´è¯¦æƒ…**ï¼š`activity/LiveRoomActivity.java`

### æ ¸å¿ƒå·¥å…·ç±»
- **é¢„åŠ è½½ç®¡ç†**ï¼š`utils/PreloadManager.java`
- **WebView é…ç½®**ï¼š`utils/WebViewConfigHelper.java`
- **æ€§èƒ½ç›‘æŽ§**ï¼š`utils/PerformanceMonitor.java`

### æ’­æ”¾å™¨
- **HTML æ’­æ”¾å™¨**ï¼š`assets/player.html`
- **æ’­æ”¾å™¨é…ç½®**ï¼šå‚è€ƒ `dash_live_final.html`


## ðŸ”® æœªæ¥è®¡åˆ’

- [ ] æ”¯æŒæ›´å¤šç›´æ’­æµæ ¼å¼ï¼ˆHLSã€FLV ç­‰ï¼‰
- [ ] æ·»åŠ ç¤¼ç‰©åŠ¨ç”»æ•ˆæžœ
- [ ] æ·»åŠ æ›´å¤šæ€§èƒ½ä¼˜åŒ–æŠ€æœ¯

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

## ðŸ‘¥ è´¡çŒ®

æ¬¢è¿Žæäº¤ Issue å’Œ Pull Requestï¼

---

=======
# Tiktok_Live_Simple
>>>>>>> f0a8e786a7a92efcb04fa96b0cd3996d9634e80d
